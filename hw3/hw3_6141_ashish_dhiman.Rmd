---
title: "HW3_ISYE6414_ashish_dhiman"
author: "Ashish Dhiman | adhiman9@gatech.edu"
date: "2022-09-12"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
setwd("~/data_projects/fall22_hw/isye6414_hw/hw3")
```

# Part 1

## Read Data and Summary

```{bash}
head -5 ./6414_HW3_Clean.csv
```

```{r}
df_demand_price = read.table(file ="./6414_HW3_Clean.csv", sep=",",header=TRUE)
head(df_demand_price)
dim(df_demand_price)
summary(df_demand_price)
```

## Question 1: Scatter Plot

```{r}
title_i = "Demand (in hundred thousands) vs Price Delta (in USD)"
plot(x=df_demand_price$PriceDif, y=df_demand_price$Demand, type ="p",main = title_i)
```

$\color{blue}{\text{From the above plot, a linear realationship between Demand and Price Difference is apparent}}$

$\color{blue}{\text{The strength of the linear realtionship can also be tested with corealtion between x and y}}$

```{r}
cor_xy = cor(df_demand_price$Demand,df_demand_price$PriceDif)
print (paste("Corealtion on full data:",round(cor_xy,2)))
```

$\color{blue}{\text{A corelation of 0.89 is pretty significant and further supports strong linear realtionship between x and y}}$

## Question 2: Simple Linear Regresssion and Intercepts

```{r}
#Fit SLR
slr_model <- lm(Demand ~ PriceDif, data = df_demand_price)
slr_model

#Superpositioning regression line on 
ggplot(df_demand_price, aes(PriceDif, Demand)) + #aes(x,y)
  geom_point() +
  stat_smooth(method = lm, se = FALSE)
```

```{r}
summary(slr_model)
```

From above summary we have:

$$
\hat{\beta_0} = 7.81409\\
\hat{\beta_1} = 2.66521\\
\hat{\sigma} = 0.3166\\
\hat{se(\beta_0)} = 0.07988\\
\hat{se(\beta_1)} = 0.25850\\
$$

### Question 3, 95% CI for \hat{\beta_1}

$$
CI\ for\ \hat{\beta_1}\ at\ (1-\alpha)\% = \hat{\beta_1} \pm t_{\frac{\alpha}{2},n-2}\sqrt{\frac{MSE}{S_{xx}}}
$$

```{r}
#In R this is given as:
confint(slr_model,level = 0.95)
print (paste("95% CI for beta1 is (2.135702,3.194727)"))
(3.194727-2.135702)/0.25850
```

Add discussion normal vs t

### Question 4: Hypothesis Test on if x is statistically significant

Here:

Null Hypothesis = $H_0: \hat{\beta_1}$

Alternate Hypothesis = $H_1: \hat{\beta_1} \neq 0$

```{r}
qt(p=0.975,df=28)
qt(p=0.025,df=28)
```

### Question 10: Derivation

For $\beta_0 = 0$, the eqn. becomes: \$\$ y_i = \beta\_1x_i + \epsilon\_i,  then\\ SSE = \sum(y_i - \hat{y_i})\^2\\ =(y_i - \beta\_1x_i)\^2\\

Derivative wrt  \beta\_1\\ \frac{\partial SSE}{\partial\beta_1} = \sum\_i\^n[2(y_i - \beta\_1x_i).(-x_i)]\\ = -2\sum\_i\^n[y_ix_i-\beta\_1.x_i\^2]\\

For minimum \frac{\partial SSE}{\partial\beta_1} = 0\\ \implies \sum\_i\^n x_i.y_i = \beta\_1.\sum\_i\^n x_i\^2\\ or beta_1 = \frac{\sum_i^n x_i.y_i}{\sum_i^n x_i^2} \$\$
